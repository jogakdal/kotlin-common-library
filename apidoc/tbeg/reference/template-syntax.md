# TBEG 템플릿 문법 레퍼런스

## 목차
1. [개요](#1-개요)
2. [변수 치환](#2-변수-치환)
3. [반복 (repeat)](#3-반복-repeat)
   - [3.7 Named Range 사용](#37-named-range-사용)
   - [3.8 수식과 다중 행 반복의 제한](#38-수식과-다중-행-반복의-제한)
   - [3.9 셀 확장과 참조 자동 조정](#39-셀-확장과-참조-자동-조정)
4. [이미지 삽입](#4-이미지-삽입)
5. [수식에서 변수 사용](#5-수식에서-변수-사용)
6. [차트 및 피벗 테이블](#6-차트-및-피벗-테이블)
7. [고급 문법](#7-고급-문법)

---

## 1. 개요

TBEG는 `.xlsx` 템플릿 파일에 데이터를 바인딩하여 Excel 파일을 생성합니다. 템플릿에서 사용할 수 있는 문법은 다음과 같습니다:

| 문법                  | 용도              | 예시                               |
|---------------------|-----------------|----------------------------------|
| `${변수명}`            | 단일 값 치환         | `${title}`                       |
| `${객체.속성}`          | 객체 속성 접근        | `${emp.name}`                    |
| `${repeat(...)}`    | 반복 데이터 확장 (텍스트) | `${repeat(employees, A3:C3)}`    |
| `=TBEG_REPEAT(...)` | 반복 데이터 확장 (수식)  | `=TBEG_REPEAT(employees, A3:C3)` |
| `${image.이름}`       | 이미지 삽입 (간단)     | `${image.logo}`                  |
| `${image(...)}`     | 이미지 삽입 (상세)     | `${image(logo, B2, 100:80)}`     |
| `=TBEG_IMAGE(...)`  | 이미지 삽입 (수식)     | `=TBEG_IMAGE(logo)`              |

### 대소문자 구분

| 구분              | 대소문자 구분 | 예시                                                        |
|-----------------|---------|-----------------------------------------------------------|
| 마커 키워드          | 구분 안 함  | `${repeat(...)}`, `${REPEAT(...)}`, `${Image.logo}` 모두 동일 |
| 변수명, 컬렉션명, 이미지명 | **구분함** | `${title}`과 `${Title}`은 다른 데이터 키 참조                       |

- 마커 키워드(`repeat`, `image`, `TBEG_REPEAT`, `TBEG_IMAGE`)는 대소문자를 구분하지 않지만, 변수명이나 컬렉션명 등은 데이터에서 전달한 키와 정확히 일치해야 합니다.
- `${image.logo}`의 경우 `image` 키워드는 대소문자 구분하지 않지만, `logo`는 데이터에서 제공한 이미지 키와 정확히 일치해야 합니다.

### 인자의 따옴표 처리

`repeat`과 `image` 마커의 인자는 따옴표 유무와 관계없이 동일하게 처리됩니다. 텍스트 형식과 수식 형식 모두 큰따옴표(`"`), 작은따옴표(`'`), 백틱(`` ` ``)을 허용하며, 따옴표는 파싱 시 무시됩니다.

```
// 모두 동일하게 동작
${repeat(employees, A3:C3, emp)}
${repeat("employees", "A3:C3", "emp")}
=TBEG_REPEAT(employees, A3:C3, emp)
=TBEG_REPEAT('employees', 'A3:C3', 'emp')
```

> **참고**: 수식 형식에서 범위 인자를 따옴표로 감싸면(`"A3:C3"`) Excel이 셀 참조가 아닌 문자열로 인식하므로, 수식 편집 시 마우스 드래그로 범위를 수정할 수 없습니다. 수식 형식의 장점을 활용하려면 범위는 따옴표 없이 작성하세요.

---

## 2. 변수 치환

### 2.1 기본 문법

```
${변수명}
```

셀에 `${변수명}` 형식으로 작성하면 해당 변수의 값으로 치환됩니다.

**템플릿:**

|   | A    | B        |
|---|------|----------|
| 1 | 제목:  | ${title} |
| 2 | 작성일: | ${date}  |

**데이터:**
```kotlin
mapOf(
    "title" to "월간 보고서",
    "date" to "2026-01-15"
)
```

**결과:**

|   | A    | B          |
|---|------|------------|
| 1 | 제목:  | 월간 보고서     |
| 2 | 작성일: | 2026-01-15 |

### 2.2 객체 속성 접근

점(`.`) 표기법으로 객체의 속성에 접근할 수 있습니다.

```
${객체명.속성명}
${객체명.속성명.하위속성}
```

**템플릿:**
```
${company.name}
${company.address.city}
```

**데이터:**
```kotlin
data class Address(val city: String, val street: String)
data class Company(val name: String, val address: Address)

mapOf(
    "company" to Company("휴넷", Address("서울", "구로구"))
)
```

### 2.3 적용 가능 위치

변수 치환은 다음 위치에서 사용할 수 있습니다:

| 위치      | 지원 | 설명                    |
|---------|----|-----------------------|
| 셀 값     | O  | 일반 셀의 텍스트             |
| 차트 제목   | O  | 차트의 제목 텍스트            |
| 차트 레이블  | O  | 데이터 레이블, 축 레이블        |
| 도형 텍스트  | O  | TextBox, Shape 내 텍스트  |
| 머리글/바닥글 | O  | 페이지 머리글, 바닥글          |
| 수식      | O  | 수식 내 값 및 셀 참조 (5장 참조) |
| 시트 이름   | X  | 지원하지 않음               |

---

## 3. 반복 (repeat)

### 3.1 기본 문법

**텍스트 형식:**
```
${repeat(컬렉션, 범위, 변수, 방향)}
```

**수식 형식:**
```
=TBEG_REPEAT(컬렉션, 범위, 변수, 방향)
```

> 두 형식은 동일한 기능을 수행합니다. 수식 형식은 Excel의 수식 셀에서 사용하기에 적합합니다.

| 파라미터 | 필수 | 설명                                 | 기본값  |
|------|----|------------------------------------|------|
| 컬렉션  | O  | 반복할 데이터 컬렉션의 이름 (데이터에서 제공한 키)      | -    |
| 범위   | O  | 반복할 셀 범위 (예: A3:C3) 또는 Named Range | -    |
| 변수   | X  | 반복 내에서 각 항목을 참조할 때 사용할 이름          | 컬렉션명 |
| 방향   | X  | 확장 방향 (DOWN 또는 RIGHT)              | DOWN |

**컬렉션과 변수의 관계:**
- **컬렉션**: 데이터에서 전달한 리스트의 키 이름입니다. `mapOf("employees" to listOf(...))`에서 `employees`가 컬렉션명입니다.
- **변수**: 반복되는 각 항목을 참조할 때 사용하는 별칭입니다. `${emp.name}`처럼 사용합니다.
- 변수를 생략하면 컬렉션명이 변수로 사용됩니다. 예: `${repeat(employees, A3:C3)}`이면 `${employees.name}`으로 참조합니다.

### 3.2 간단한 예시

**템플릿:**

|   | A                                | B               | C             |
|---|----------------------------------|-----------------|---------------|
| 1 | ${repeat(employees, A3:C3, emp)} |                 |               |
| 2 | 이름                               | 직급              | 급여            |
| 3 | ${emp.name}                      | ${emp.position} | ${emp.salary} |

> 참고: `${repeat(...)}` 마커는 워크북 내 어디에 있어도 됩니다. 다른 시트에 있어도 상관없습니다. 마커의 위치와 관계없이 `범위` 파라미터로 지정된 영역이 반복됩니다. 마커가 있는 셀 내용은 생성 시 자동으로 삭제됩니다.

**데이터:**
```kotlin
data class Employee(val name: String, val position: String, val salary: Int)

mapOf(
    "employees" to listOf(
        Employee("황용호", "부장", 8000),
        Employee("한용호", "과장", 6500),
        Employee("홍용호", "대리", 4500)
    )
)
```

**결과:**

|   | A   | B  | C    |
|---|-----|----|------|
| 1 |     |    |      |
| 2 | 이름  | 직급 | 급여   |
| 3 | 황용호 | 부장 | 8000 |
| 4 | 한용호 | 과장 | 6500 |
| 5 | 홍용호 | 대리 | 4500 |

### 3.3 파라미터 작성 방식

#### 텍스트 형식 - 위치 기반 (간결)
```
${repeat(employees, A3:C3, emp, DOWN)}
${repeat(employees, A3:C3, emp)}        // direction 생략 (기본: DOWN)
${repeat(employees, A3:C3)}              // var 생략 (컬렉션명을 변수로 사용)
```

#### 텍스트 형식 - 이름 기반 (명시적)
```
${repeat(collection=employees, range=A3:C3, var=emp, direction=DOWN)}
```

#### 수식 형식
```
=TBEG_REPEAT(employees, A3:C3, emp, DOWN)
=TBEG_REPEAT(employees, A3:C3, emp)   // direction 생략 (기본: DOWN)
=TBEG_REPEAT(employees, A3:C3)        // var, direction 생략
```

#### Named Range 사용
```
${repeat(employees, DataRange, emp)}
=TBEG_REPEAT(employees, DataRange, emp)
```

> 참고: 모든 파라미터는 따옴표 유무와 관계없이 동일하게 처리됩니다.
> `${repeat(employees, A3:C3)}`, `${repeat("employees", "A3:C3")}`, `${repeat('employees', 'A3:C3')}` 모두 같은 결과를 생성합니다.

### 3.4 다중 행/열 범위

범위는 반드시 한 행 또는 한 열일 필요가 없습니다. 여러 행(또는 열)을 범위로 지정하면 해당 범위 전체가 하나의 단위로 반복됩니다.

**템플릿 (A1:C3, 3행 범위):**

|   | A                 | B                    | C                                |
|---|-------------------|----------------------|----------------------------------|
| 1 | ${emp.name}       | ${emp.position}      | ${repeat(employees, A1:C3, emp)} |
| 2 | ${emp.department} | 입사일: ${emp.hireDate} |                                  |
| 3 | 급여: ${emp.salary} |                      |                                  |

> 마커는 C1에 있고, 범위 A1:C3(행 1~3)이 반복됩니다. 마커 셀의 내용은 생성 시 삭제됩니다.

**결과 (직원 2명일 경우):**

|   | A        | B               | C |
|---|----------|-----------------|---|
| 1 | 황용호      | 과장              |   |
| 2 | 공통플랫폼팀   | 입사일: 2020-03-15 |   |
| 3 | 급여: 5000 |                 |   |
| 4 | 홍용호      | 대리              |   |
| 5 | 영업팀      | 입사일: 2022-01-10 |   |
| 6 | 급여: 4000 |                 |   |

이 방식으로 각 항목에 대해 복잡한 레이아웃을 적용할 수 있습니다.

> ⚠️ **주의**: 다중 행 범위를 사용할 때 수식 제한 사항이 있습니다. 자세한 내용은 [3.7 수식과 다중 행 반복의 제한](#37-수식과-다중-행-반복의-제한)을 참조하세요.

### 3.5 확장 방향

#### DOWN (기본값) - 아래 방향으로 확장
```
${repeat(items, A2:C2, item, DOWN)}
```

|   | A     | B   | C   |
|---|-------|-----|-----|
| 1 | 헤더1   | 헤더2 | 헤더3 |
| 2 | item1 | ... | ... |
| 3 | item2 | ... | ... |
| 4 | item3 | ... | ... |

#### RIGHT - 오른쪽 방향으로 확장
```
${repeat(months, B1:B3, month, RIGHT)}
```

|   | A  | B   | C   | D   |
|---|----|-----|-----|-----|
| 1 |    | 1월  | 2월  | 3월  |
| 2 | 매출 | 100 | 150 | 200 |
| 3 | 비용 | 80  | 90  | 100 |

### 3.6 다른 시트의 범위 지정

마커는 워크북 내 어느 시트에나 위치할 수 있습니다. 범위 지정 방식에 따라 반복이 일어나는 시트가 결정됩니다.

#### 시트명 생략 (마커가 있는 시트에서 반복)
```
${repeat(employees, A3:C3, emp)}
```
마커가 있는 시트의 A3:C3 범위에서 반복됩니다.

#### 시트명 포함 (지정된 시트에서 반복)
```
${repeat(employees, 'Sheet1'!A3:C3, emp)}
${repeat(employees, "데이터시트"!A3:C3, emp)}
```
마커가 어느 시트에 있든, 지정된 시트('Sheet1' 또는 '데이터시트')의 A3:C3 범위에서 반복됩니다.

> 시트 이름에 공백이나 특수문자가 있으면 따옴표로 감싸야 합니다.

**활용 예시:** 모든 repeat 마커를 별도의 "설정" 시트에 모아두고, 각 마커에서 실제 데이터가 출력될 시트와 범위를 지정할 수 있습니다.

### 3.7 Named Range 사용

셀 범위 대신 Excel의 Named Range(이름 정의)를 사용할 수 있습니다.

> **Named Range란?** Excel에서 특정 셀 범위에 이름을 부여하는 기능입니다. 예를 들어 `A3:C3` 범위에 `DataRange`라는 이름을 지정하면, 수식이나 참조에서 `A3:C3` 대신 `DataRange`를 사용할 수 있습니다.

#### 설정 방법

1. Excel에서 반복할 영역 선택
2. 수식 탭 → 이름 정의 → 이름 입력 (예: `DataRange`)
3. 템플릿에서 Named Range 사용

#### 사용 예시

```
${repeat(employees, DataRange, emp)}
=TBEG_REPEAT(employees, DataRange, emp)
```

#### 장점

- **가독성**: 셀 주소보다 의미 있는 이름 사용
- **유지보수**: 범위 변경 시 Named Range만 수정하면 됨
- **안전성**: 행/열 추가 시에도 범위가 자동 유지됨

### 3.8 수식과 다중 행 반복의 제한

다중 행 범위로 반복할 때 수식에서 제한이 발생할 수 있습니다.

#### 문제 상황

다중 행 범위(예: A3:C5)를 사용하면 각 데이터 항목이 여러 행을 차지합니다. 이때 특정 셀을 참조하는 수식(예: `=SUM(B3)`)은 반복으로 생성된 모든 해당 셀을 참조해야 합니다.

**예시:**
- 템플릿: 3행 범위(A3:C5)로 반복, B4 셀에 급여 데이터
- 수식: `=SUM(B4)` (급여 합계)
- 데이터: 100명의 직원

반복 후 급여 데이터는 B4, B7, B10, B13, ... (3행 간격)에 배치됩니다. 이 비연속적인 셀들을 합산하려면 수식이 다음과 같이 확장됩니다:

```
=SUM(B4, B7, B10, B13, ..., B301)
```

#### Excel 함수 인자 수 제한

Excel 함수는 최대 **255개**의 인자만 허용합니다. 위 예시에서 100명의 직원 데이터는 100개의 비연속 셀 참조가 필요하므로 문제없지만, **255명을 초과하면 `FormulaExpansionException`이 발생**합니다.

#### 해결 방법

1. **1행 1데이터 구조 사용**: 단일 행 범위(예: A3:C3)로 반복하면 셀이 연속적으로 배치되어 `=SUM(B3:B302)` 형태로 확장됩니다. 이 경우 인자 수 제한이 적용되지 않습니다.

2. **데이터 레벨 집계**: 수식 대신 DataProvider에서 미리 집계된 값을 제공합니다.
   ```kotlin
   mapOf(
       "employees" to employees,
       "totalSalary" to employees.sumOf { it.salary }  // 미리 집계
   )
   ```

3. **데이터 분할**: 255개 이하의 데이터로 분할하여 처리합니다.

### 3.9 셀 확장과 참조 자동 조정

repeat으로 행(또는 열)이 확장되면, 확장 방향의 연장선에 있는 셀들이 자동으로 밀립니다. 이때 밀린 셀을 참조하는 **수식**과 **이미지 위치**도 자동으로 조정됩니다.

**예시:**

템플릿에서 A2:C2 범위를 DOWN 방향으로 반복하고, A10 셀에 합계 수식 `=SUM(C2:C2)`이 있다고 가정합니다.

|    | A                                | B               | C             |
|----|----------------------------------|-----------------|---------------|
| 1  | ${repeat(employees, A2:C2, emp)} |                 |               |
| 2  | ${emp.name}                      | ${emp.position} | ${emp.salary} |
|    | ...                              | ...             | ...           |
| 10 | 합계                               |                 | =SUM(C2:C2)   |

5명의 직원 데이터로 생성하면:

1. A2:C2 범위가 5행으로 확장됨 (A2:C6)
2. 기존 A10에 있던 합계 행이 A14로 밀림
3. 수식이 `=SUM(C2:C6)`으로 자동 조정됨

**자동 조정 대상:**
- **수식**: 밀린 셀을 참조하는 수식의 셀 주소가 자동 갱신됨
- **이미지 위치**: `image` 마커의 `position` 파라미터로 지정한 셀 주소가 자동 갱신됨

> 이 동작은 사용자가 별도로 설정할 필요 없이 자동으로 이루어집니다.

---

## 4. 이미지 삽입

### 4.1 기본 문법

이미지 삽입을 위한 세 가지 문법을 지원합니다. 일반적인 이미지 형식(PNG, JPEG, GIF, BMP 등)은 모두 지원됩니다.

**간단 문법 (셀 크기에 맞춤):**
```
${image.이미지명}
```

**상세 문법 (위치, 크기 지정):**
```
${image(이미지명, 위치, 크기)}
```

**수식 형식:**
```
=TBEG_IMAGE(이미지명)           // 마커 셀 위치에 삽입
=TBEG_IMAGE(이미지명, 범위)      // 지정 범위에 맞춰 삽입
=TBEG_IMAGE(이미지명, 위치, 크기) // 위치와 크기 지정
```

### 4.2 간단 문법 예시

셀에 `${image.이름}` 형식으로 작성하면 해당 셀 크기에 맞게 이미지가 삽입됩니다.

**템플릿:**

|   | A  | B             |
|---|----|---------------|
| 1 | 로고 | ${image.logo} |

**데이터:**
```kotlin
val logoBytes = File("logo.png").readBytes()

simpleDataProvider {
    image("logo", logoBytes)
}
```

### 4.3 상세 문법 예시

위치와 크기를 명시적으로 지정할 수 있습니다.

```
${image(logo, B2, 100:80)}         // B2 셀에 100:80 픽셀 크기로 삽입
${image(logo, B2:D5)}              // B2:D5 범위에 맞춰 삽입
=TBEG_IMAGE(logo, B2:D5)           // 수식 형식
=TBEG_IMAGE(logo, B2, 100:80)      // 수식 형식 + 크기 지정
```

| 파라미터 | 설명              | 예시            |
|------|-----------------|---------------|
| 이미지명 | 데이터에서 제공한 이미지 키 | `logo`        |
| 위치   | 셀 주소 또는 범위      | `B2`, `B2:D5` |
| 크기   | 너비:높이 (픽셀)      | `100:80`      |

### 4.4 이미지 크기 조절

이미지는 다음 우선순위로 크기가 결정됩니다:

1. **크기 파라미터 지정**: `100:80` 형식으로 픽셀 크기 직접 지정
2. **범위 지정**: `B2:D5` 형식으로 범위 지정 시 해당 범위에 맞춤
3. **셀 크기**: 위 두 가지가 없으면 마커가 있는 셀(또는 병합된 셀)에 맞춤

#### 크기 인자 상세

크기는 `너비:높이` 형식으로 지정하며, 각 값에 따라 다르게 동작합니다.

| 너비 | 높이 | 동작               | 예시       |
|----|----|------------------|----------|
| 양수 | 양수 | 지정된 크기 사용        | `100:80` |
| 0  | 0  | 셀 크기에 맞춤 (기본값)   | `0:0`    |
| 0  | -1 | 셀 너비에 맞추고 비율 유지  | `0:-1`   |
| -1 | 0  | 셀 높이에 맞추고 비율 유지  | `-1:0`   |
| -1 | -1 | 원본 크기 유지         | `-1:-1`  |
| 양수 | -1 | 너비 고정, 높이는 비율 유지 | `200:-1` |
| -1 | 양수 | 높이 고정, 너비는 비율 유지 | `-1:150` |
모든 음수 값은 `-1`과 동일하게 취급됩니다.
 
**활용 예시:**
```
${image(logo, B2, 0:-1)}      // 셀 너비에 맞추고 비율 유지 (가로 기준)
${image(logo, B2, -1:0)}      // 셀 높이에 맞추고 비율 유지 (세로 기준)
${image(logo, B2, 200:-1)}    // 너비 200px 고정, 높이는 비율 유지
${image(logo, B2, -1:-1)}     // 원본 크기 그대로 삽입
```

---

## 5. 수식에서 변수 사용

### 5.1 기본 사용법

Excel 수식 내에서도 `${변수}` 문법을 사용할 수 있습니다.

**템플릿 셀 수식:**
```
=SUM(B${startRow}:B${endRow})
```

**데이터:**
```kotlin
mapOf(
    "startRow" to 2,
    "endRow" to 10
)
```

**생성된 수식:**
```
=SUM(B2:B10)
```

### 5.2 동적 셀 참조

데이터에 따라 수식의 참조 범위를 동적으로 설정할 수 있습니다.

**템플릿:**
```
=AVERAGE(${rangeStart}:${rangeEnd})
```

**데이터:**
```kotlin
mapOf(
    "rangeStart" to "C2",
    "rangeEnd" to "C100"
)
```

### 5.3 주의사항

- 수식 내 변수는 데이터 바인딩 후 치환됩니다
- 복잡한 수식의 경우 테스트를 권장합니다
- 순환 참조가 발생하지 않도록 주의하세요

---

## 6. 차트 및 피벗 테이블

### 6.1 차트

템플릿에 포함된 차트는 생성된 Excel 파일에 그대로 보존됩니다.

**지원되는 기능:**
- 모든 차트 유형 보존 (막대, 꺾은선, 원형, 분산형 등)
- 차트 스타일 및 레이아웃 보존
- 차트 제목, 데이터 레이블, 축 레이블에서 `${변수}` 치환

**변수 치환 예시:**

차트 제목에 `${title}` 입력 시, 데이터의 `title` 값으로 치환됩니다.

### 6.2 피벗 테이블

템플릿에 피벗 테이블이 있으면 확장된 데이터가 자동으로 반영됩니다.

**동작 방식:**
1. 템플릿의 피벗 테이블 설정(필드, 스타일 등)을 보존
2. 데이터 소스 범위를 확장된 데이터에 맞게 자동 조정
3. 피벗 테이블에 변경 사항 자동 반영
4. 피벗 테이블과 연결된 피벗 차트도 함께 보존

---

## 7. 고급 문법

### 7.1 조건부 출력

본 라이브러리는 조건부 출력 문법을 제공하지 않습니다. 조건부 출력이 필요한 경우 다음 대안을 권장합니다:

1. **데이터 전처리**: 조건에 맞는 데이터만 필터링하여 전달
2. **Excel 조건부 서식**: 템플릿에 조건부 서식 설정
3. **빈 값 처리**: 조건에 맞지 않으면 빈 문자열 전달

**예시 - 데이터 전처리:**
```kotlin
val activeEmployees = employees.filter { it.status == "ACTIVE" }

mapOf(
    "employees" to activeEmployees
)
```

### 7.2 하이퍼링크

동적 하이퍼링크가 필요한 경우 Excel의 `HYPERLINK` 함수를 사용하세요.

**템플릿 셀에 수식 입력:**
```
=HYPERLINK("${url}", "${linkText}")
```

**데이터:**
```kotlin
mapOf(
    "linkText" to "홈페이지 바로가기",
    "url" to "https://www.hunet.co.kr"
)
```

**결과:** "홈페이지 바로가기" 텍스트가 표시되고, 클릭 시 해당 URL로 이동합니다.

### 7.3 데이터 유효성 검사 (드롭다운)

템플릿에 설정된 데이터 유효성 검사는 반복 영역에도 자동으로 확장됩니다.

**동작:**
1. 템플릿의 데이터 유효성 검사 규칙 감지
2. 반복으로 생성된 행에 동일한 규칙 적용

### 7.4 병합 셀

병합된 셀에서도 변수를 사용할 수 있습니다. 반복 영역 내 병합 셀도 정상적으로 복제됩니다.

---

## 오류 메시지

### 템플릿 전처리 오류

| 오류 메시지                   | 원인               | 해결 방법            |
|--------------------------|------------------|------------------|
| `닫는 괄호 ')'가 누락되었습니다`     | repeat 마커의 문법 오류 | 괄호를 올바르게 닫으세요    |
| `닫는 중괄호 '}'가 누락되었습니다`    | 변수 마커의 문법 오류     | 중괄호를 올바르게 닫으세요   |
| `필수 파라미터 누락: collection` | repeat에 컬렉션 미지정  | 컬렉션 이름을 지정하세요    |
| `필수 파라미터 누락: range`      | repeat에 범위 미지정   | 셀 범위를 지정하세요      |
| `잘못된 범위 형식`              | 셀 범위 문법 오류       | A1:C3 형식으로 작성하세요 |
| `시트를 찾을 수 없음`            | 존재하지 않는 시트 참조    | 시트 이름을 확인하세요     |

### 수식 확장 오류

| 오류                          | 원인                          | 해결 방법                                         |
|-----------------------------|-----------------------------|-----------------------------------------------|
| `FormulaExpansionException` | 다중 행 반복에서 비연속 셀 참조가 255개 초과 | [3.7 수식과 다중 행 반복의 제한](#37-수식과-다중-행-반복의-제한) 참조 |

---

## 다음 단계

- [API 레퍼런스](./api-reference.md) - ExcelGenerator API 상세
- [기본 예제](../examples/basic-examples.md) - 템플릿과 코드 예제
- [사용자 가이드](../user-guide.md) - 전체 가이드
